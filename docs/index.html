<head><link href="style.css" rel="stylesheet"/></head>
<div class="nav"><a href="https://github.com/mlochbaum/BQN">BQN</a></div>
<h1 id="bqn-finally-an-apl-for-your-flying-saucer">BQN: finally, an APL for your flying saucer</h1>
<p><em>Try it <a href="https://mlochbaum.github.io/BQN/try.html">here</a>! The online version is mainly good for small programs currently; see <a href="running.html">running.md</a> for more options.</em></p>
<p><strong>BQN</strong> is a new programming language in the APL lineage, which aims to remove inconsistent and burdensome aspects of the APL tradition and put the great ideas on a firmer footing. BQN is aimed at existing and aspiring APL-family programmers, and using it requires a solid understanding of functions and multidimensional arrays. However, because of its focus on providing simple, consistent, and powerful array operations, BQN should also be a good language for learning array programming and building stronger array intuition.</p>
<p>BQN maintains many of the ideas that made APL\360 revolutionary in 1966:</p>
<ul>
<li>Human-friendly <strong>infix notation</strong> with no precedence rules to remember.</li>
<li><strong>Built-in array operations</strong> handle any number of dimensions easily.</li>
<li><strong>Higher-order functions</strong> allow basic functions to be applied in more powerful ways.</li>
</ul>
<p>It incorporates concepts developed over years of APL practice:</p>
<ul>
<li>The <a href="doc/leading.html"><strong>leading axis model</strong></a>, which allows for simpler built-in functions.</li>
<li>Trains and combinators for <strong>tacit programming</strong>.</li>
<li>Lightweight <strong>anonymous functions</strong> (like <a href="https://aplwiki.com/wiki/Dfn">dfns</a>).</li>
</ul>
<p>But BQN is redesigned from the ground up, with brand new ideas to make these paradigms easier to use and less likely to fail.</p>
<ul>
<li>The <strong>based array model</strong> makes non-arrays a fundamental part of the language, and removes the surprise of floating arrays and the hassle of explicit boxes. New <strong>array notation</strong> eliminates the gotchas of <a href="https://aplwiki.com/wiki/Strand_notation">stranding</a>.</li>
<li>A <a href="doc/context.html"><strong>context-free grammar</strong></a> where a value's syntactic role is determined by its spelling makes it easier for machines and humans to understand code.</li>
<li>Oh, and it naturally leads to <a href="doc/functional.html"><strong>first-class functions</strong></a>, a feature often missed in APL.</li>
<li>The <strong>new symbols</strong> for built-in functionality allow the syntactic role of a primitive to be distinguished at a glance, and aim to be more consistent and intuitive.</li>
</ul>
<h2 id="what-kind-of-name-is-bqn">What kind of name is &quot;BQN&quot;?</h2>
<p>It's three letters, that happen to match the capitals in &quot;Big Questions Notation&quot;. You can pronounce it &quot;bacon&quot;, but are advised to avoid this unless there's puns.</p>
<h2 id="what-does-bqn-look-like">What does BQN look like?</h2>
<p>Rather strange, most likely:</p>
<pre>    <span class='Function'>⊑+</span><span class='Modifier'>`</span><span class='Modifier2'>∘</span><span class='Function'>⌽</span><span class='Modifier2'>⍟</span><span class='Number'>12</span><span class='Function'>↕</span><span class='Number'>2</span>  <span class='Comment'># The 12th Fibonacci number
</span>144
</pre>
<p>For longer samples, you can <a href="https://github.com/mlochbaum/BQN/blob/master/src/c.bqn">gaze into the abyss</a> that is the self-hosted compiler, or the <a href="https://github.com/mlochbaum/BQN/blob/master/src/r.bqn">shallower but wider abyss</a> of the runtime, or take a look at the friendlier <a href="https://github.com/mlochbaum/BQN/blob/master/md.bqn">markdown processor</a> used to format and highlight documentation files. There are also <a href="https://github.com/mlochbaum/BQN/blob/master/examples/fifty.bqn">some translations</a> from <a href="https://www.jsoftware.com/papers/50/">&quot;A History of APL in 50 Functions&quot;</a> here.</p>
<h2 id="array-model">Array model</h2>
<p>Most of BQN's functionality deals with the manipulation of multidimensional arrays. However, it discards many of the complications of traditional APL <a href="https://aplwiki.com/wiki/Array_model">array models</a>. Unlike in APL, non-array data is possible, and common: numbers, characters, and functions are not arrays (see the full list of <a href="#types">types</a> below). This avoids some difficulties that show up when trying to treat scalar arrays as the fundamental unit; in particular, there is no &quot;floating&quot; so a value is always different from a scalar array that contains it. This system has been <a href="https://dl.acm.org/doi/abs/10.1145/586656.586663">proposed</a> in APL's past under the name <strong>based array theory</strong>.</p>
<p>Currently, the intention is that arrays will not have prototypes, so that all empty arrays of the same shape behave identically. Different elements of an array should not influence each other. While some APLs force numbers placed in the same array to a common representation, which may have different precision properties, BQN will enforce 64-bit floating-point precision, and only use representations or methods compatible with it (for example, integers up to 32 bits).</p>
<h2 id="built-in-operations">Built-in operations</h2>
<h3 id="functions">Functions</h3>
<p>Functions that have significant differences from APL functions are marked with an asterisk. Links for these entries go to dedicated BQN documentation while other links go to the APL Wiki.</p>
<table>
<thead>
<tr>
<th>Glyph</th>
<th>Monadic</th>
<th>Dyadic</th>
</tr>
</thead>
<tbody>
<tr>
<td><code><span class='Function'>+</span></code></td>
<td><a href="https://aplwiki.com/wiki/Conjugate">Conjugate</a></td>
<td><a href="https://aplwiki.com/wiki/Add">Add</a></td>
</tr>
<tr>
<td><code><span class='Function'>-</span></code></td>
<td><a href="https://aplwiki.com/wiki/Negate">Negate</a></td>
<td><a href="https://aplwiki.com/wiki/Subtract">Subtract</a></td>
</tr>
<tr>
<td><code><span class='Function'>×</span></code></td>
<td><a href="https://aplwiki.com/wiki/Signum">Sign</a></td>
<td><a href="https://aplwiki.com/wiki/Times">Multiply</a></td>
</tr>
<tr>
<td><code><span class='Function'>÷</span></code></td>
<td><a href="https://aplwiki.com/wiki/Reciprocal">Reciprocal</a></td>
<td><a href="https://aplwiki.com/wiki/Divide">Divide</a></td>
</tr>
<tr>
<td><code><span class='Function'>⋆</span></code></td>
<td><a href="https://aplwiki.com/wiki/Exponential">Exponential</a></td>
<td><a href="https://aplwiki.com/wiki/Power_(function)">Power</a></td>
</tr>
<tr>
<td><code><span class='Function'>√</span></code></td>
<td><a href="https://aplwiki.com/wiki/Square_Root">Square Root</a></td>
<td><a href="https://aplwiki.com/wiki/Root">Root</a></td>
</tr>
<tr>
<td><code><span class='Function'>⌊</span></code></td>
<td><a href="https://aplwiki.com/wiki/Floor">Floor</a></td>
<td><a href="https://aplwiki.com/wiki/Minimum">Minimum</a></td>
</tr>
<tr>
<td><code><span class='Function'>⌈</span></code></td>
<td><a href="https://aplwiki.com/wiki/Ceiling">Ceiling</a></td>
<td><a href="https://aplwiki.com/wiki/Maximum">Maximum</a></td>
</tr>
<tr>
<td><code><span class='Function'>∧</span></code></td>
<td>Sort Up</td>
<td><a href="doc/logic.html">And</a>*</td>
</tr>
<tr>
<td><code><span class='Function'>∨</span></code></td>
<td>Sort Down</td>
<td><a href="doc/logic.html">Or</a>*</td>
</tr>
<tr>
<td><code><span class='Function'>¬</span></code></td>
<td><a href="doc/logic.html">Not</a>*</td>
<td><a href="doc/logic.html">Span</a>*</td>
</tr>
<tr>
<td><code><span class='Function'>|</span></code></td>
<td><a href="https://aplwiki.com/wiki/Magnitude">Absolute Value</a></td>
<td><a href="https://aplwiki.com/wiki/Residue">Modulus</a></td>
</tr>
<tr>
<td><code><span class='Function'>≤</span></code></td>
<td></td>
<td><a href="https://aplwiki.com/wiki/Less_than_or_Equal_to">Less Than or Equal to</a></td>
</tr>
<tr>
<td><code><span class='Function'>&lt;</span></code></td>
<td><a href="https://aplwiki.com/wiki/Enclose">Enclose</a></td>
<td><a href="https://aplwiki.com/wiki/Less_than">Less Than</a></td>
</tr>
<tr>
<td><code><span class='Function'>&gt;</span></code></td>
<td><a href="doc/couple.html">Merge</a>*</td>
<td><a href="https://aplwiki.com/wiki/Greater_than">Greater Than</a></td>
</tr>
<tr>
<td><code><span class='Function'>≥</span></code></td>
<td></td>
<td><a href="https://aplwiki.com/wiki/Greater_than_or_Equal_to">Greater Than or Equal to</a></td>
</tr>
<tr>
<td><code><span class='Function'>=</span></code></td>
<td>Rank</td>
<td><a href="https://aplwiki.com/wiki/Equal_to">Equals</a></td>
</tr>
<tr>
<td><code><span class='Function'>≠</span></code></td>
<td><a href="https://aplwiki.com/wiki/Tally">Length</a></td>
<td><a href="https://aplwiki.com/wiki/Not_Equal_to">Not Equals</a></td>
</tr>
<tr>
<td><code><span class='Function'>≡</span></code></td>
<td><a href="doc/depth.html">Depth</a>*</td>
<td><a href="https://aplwiki.com/wiki/Match">Match</a></td>
</tr>
<tr>
<td><code><span class='Function'>≢</span></code></td>
<td><a href="https://aplwiki.com/wiki/Shape">Shape</a></td>
<td><a href="https://aplwiki.com/wiki/Not_Match">Not Match</a></td>
</tr>
<tr>
<td><code><span class='Function'>⊣</span></code></td>
<td><a href="https://aplwiki.com/wiki/Identity">Identity</a></td>
<td><a href="https://aplwiki.com/wiki/Identity">Left</a></td>
</tr>
<tr>
<td><code><span class='Function'>⊢</span></code></td>
<td><a href="https://aplwiki.com/wiki/Identity">Identity</a></td>
<td><a href="https://aplwiki.com/wiki/Identity">Right</a></td>
</tr>
<tr>
<td><code><span class='Function'>⥊</span></code></td>
<td><a href="https://aplwiki.com/wiki/Ravel">Deshape</a></td>
<td><a href="https://aplwiki.com/wiki/Reshape">Reshape</a></td>
</tr>
<tr>
<td><code><span class='Function'>∾</span></code></td>
<td><a href="doc/join.html">Join</a>*</td>
<td><a href="https://aplwiki.com/wiki/Catenate">Join to</a></td>
</tr>
<tr>
<td><code><span class='Function'>≍</span></code></td>
<td><a href="doc/couple.html">Solo</a>*</td>
<td><a href="doc/couple.html">Couple</a>*</td>
</tr>
<tr>
<td><code><span class='Function'>↑</span></code></td>
<td><a href="doc/prefixes.html">Prefixes</a>*</td>
<td><a href="https://aplwiki.com/wiki/Take">Take</a></td>
</tr>
<tr>
<td><code><span class='Function'>↓</span></code></td>
<td><a href="doc/prefixes.html">Suffixes</a>*</td>
<td><a href="https://aplwiki.com/wiki/Drop">Drop</a></td>
</tr>
<tr>
<td><code><span class='Function'>↕</span></code></td>
<td><a href="https://aplwiki.com/wiki/Index_Generator">Range</a></td>
<td><a href="doc/windows.html">Windows</a>*</td>
</tr>
<tr>
<td><code><span class='Function'>⌽</span></code></td>
<td><a href="https://aplwiki.com/wiki/Reverse">Reverse</a></td>
<td><a href="https://aplwiki.com/wiki/Rotate">Rotate</a></td>
</tr>
<tr>
<td><code><span class='Function'>⍉</span></code></td>
<td><a href="doc/transpose.html">Transpose</a>*</td>
<td><a href="doc/transpose.html">Reorder axes</a>*</td>
</tr>
<tr>
<td><code><span class='Function'>/</span></code></td>
<td><a href="https://aplwiki.com/wiki/Indices">Indices</a></td>
<td><a href="https://aplwiki.com/wiki/Replicate">Replicate</a></td>
</tr>
<tr>
<td><code><span class='Function'>⍋</span></code></td>
<td><a href="https://aplwiki.com/wiki/Grade">Grade Up</a></td>
<td><a href="https://aplwiki.com/wiki/Interval_Index">Bins Up</a></td>
</tr>
<tr>
<td><code><span class='Function'>⍒</span></code></td>
<td><a href="https://aplwiki.com/wiki/Grade">Grade Down</a></td>
<td><a href="https://aplwiki.com/wiki/Interval_Index">Bins Down</a></td>
</tr>
<tr>
<td><code><span class='Function'>⊏</span></code></td>
<td>First Cell*</td>
<td>Select*</td>
</tr>
<tr>
<td><code><span class='Function'>⊑</span></code></td>
<td><a href="https://aplwiki.com/wiki/First">First</a></td>
<td>Pick*</td>
</tr>
<tr>
<td><code><span class='Function'>⊐</span></code></td>
<td></td>
<td><a href="https://aplwiki.com/wiki/Index_Of">Index of</a></td>
</tr>
<tr>
<td><code><span class='Function'>⊒</span></code></td>
<td>Occurrence Count*</td>
<td>Progressive Index of*</td>
</tr>
<tr>
<td><code><span class='Function'>∊</span></code></td>
<td><a href="https://aplwiki.com/wiki/Nub_Sieve">Unique Mask</a></td>
<td><a href="https://aplwiki.com/wiki/Membership">Member of</a></td>
</tr>
<tr>
<td><code><span class='Function'>⍷</span></code></td>
<td><a href="https://aplwiki.com/wiki/Unique">Deduplicate</a></td>
<td><a href="https://aplwiki.com/wiki/Find">Find</a></td>
</tr>
<tr>
<td><code><span class='Function'>⊔</span></code></td>
<td><a href="doc/group.html">Group Indices</a>*</td>
<td><a href="doc/group.html">Group</a>*</td>
</tr>
</tbody>
</table>
<h3 id="modifiers">Modifiers</h3>
<p><em>Combinators</em> only control the application of functions. Because a non-function operand applies as a constant function, some combinators have extra meanings when passed a constant. For example, <code><span class='Number'>0</span><span class='Modifier'>˜</span></code> is the constant function that always returns 0 and <code><span class='Number'>0</span><span class='Modifier2'>⊸</span><span class='Function'>&lt;</span></code> is the function that tests whether its right argument is greater than 0.</p>
<table>
<thead>
<tr>
<th>Glyph</th>
<th>Name(s)</th>
<th>Definition</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code><span class='Modifier'>˜</span></code></td>
<td>Self/Swap</td>
<td><code><span class='Brace'>{</span><span class='Value'>𝕩</span><span class='Function'>𝔽</span><span class='Value'>𝕨</span><span class='Function'>⊣</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td>Duplicate one argument or exchange two</td>
</tr>
<tr>
<td><code><span class='Modifier2'>∘</span></code></td>
<td>Atop</td>
<td><code><span class='Brace'>{</span><span class='Function'>𝔽</span><span class='Value'>𝕨</span><span class='Function'>𝔾</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td>Apply <code><span class='Function'>𝔾</span></code> to both arguments and <code><span class='Function'>𝔽</span></code> to the result</td>
</tr>
<tr>
<td><code><span class='Modifier2'>○</span></code></td>
<td>Over</td>
<td><code><span class='Brace'>{</span><span class='Paren'>(</span><span class='Function'>𝔾</span><span class='Value'>𝕨</span><span class='Paren'>)</span><span class='Function'>𝔽𝔾</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td>Apply <code><span class='Function'>𝔾</span></code> to each argument and <code><span class='Function'>𝔽</span></code> to the results</td>
</tr>
<tr>
<td><code><span class='Modifier2'>⊸</span></code></td>
<td>Before/Bind</td>
<td><code><span class='Brace'>{</span><span class='Paren'>(</span><span class='Function'>𝔽</span><span class='Value'>𝕨</span><span class='Function'>⊣</span><span class='Value'>𝕩</span><span class='Paren'>)</span><span class='Function'>𝔾</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td><code><span class='Function'>𝔾</span></code>'s left argument comes from <code><span class='Function'>𝔽</span></code></td>
</tr>
<tr>
<td><code><span class='Modifier2'>⟜</span></code></td>
<td>After/Bind</td>
<td><code><span class='Brace'>{</span><span class='Paren'>(</span><span class='Value'>𝕨</span><span class='Function'>⊣</span><span class='Value'>𝕩</span><span class='Paren'>)</span><span class='Function'>𝔽𝔾</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td><code><span class='Function'>𝔽</span></code>'s right argument comes from <code><span class='Function'>𝔾</span></code></td>
</tr>
<tr>
<td><code><span class='Modifier2'>⌾</span></code></td>
<td>Under</td>
<td><code><span class='Brace'>{</span><span class='Function'>𝔾</span><span class='Modifier'>⁼</span><span class='Modifier2'>∘</span><span class='Function'>𝔽</span><span class='Modifier2'>○</span><span class='Function'>𝔾</span><span class='Brace'>}</span></code> OR <code><span class='Brace'>{</span><span class='Paren'>(</span><span class='Function'>𝔾</span><span class='Value'>𝕩</span><span class='Paren'>)</span><span class='Gets'>↩</span><span class='Value'>𝕨</span><span class='Function'>𝔽</span><span class='Modifier2'>○</span><span class='Function'>𝔾</span><span class='Value'>𝕩</span><span class='Separator'>⋄</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td>Apply <code><span class='Function'>𝔽</span></code> over <code><span class='Function'>𝔾</span></code>, then undo <code><span class='Function'>𝔾</span></code></td>
</tr>
<tr>
<td><code><span class='Modifier2'>⊘</span></code></td>
<td>Valences</td>
<td><code><span class='Brace'>{</span><span class='Function'>𝔽</span><span class='Value'>𝕩;𝕨</span><span class='Function'>𝔾</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td>Apply <code><span class='Function'>𝔽</span></code> if there's one argument but <code><span class='Function'>𝔾</span></code> if there are two</td>
</tr>
<tr>
<td><code><span class='Modifier2'>◶</span></code></td>
<td>Choose</td>
<td><code><span class='Brace'>{</span><span class='Value'>f</span><span class='Gets'>←</span><span class='Paren'>(</span><span class='Value'>𝕨</span><span class='Function'>𝔽</span><span class='Value'>𝕩</span><span class='Paren'>)</span><span class='Function'>⊑</span><span class='Value'>𝕘</span> <span class='Separator'>⋄</span> <span class='Value'>𝕨</span><span class='Function'>F</span><span class='Value'>𝕩</span><span class='Brace'>}</span></code></td>
<td>Select one of the functions in list <code><span class='Value'>𝕘</span></code> based on <code><span class='Function'>𝔽</span></code></td>
</tr>
</tbody>
</table>
<p>Choose isn't really a combinator since it calls the function <code><span class='Function'>⊑</span></code>, and Under is not a true combinator since it has an &quot;undo&quot; step at the end. This step might be implemented using the left operand's inverse (<em>computational</em> Under) or its structural properties (<em>structural</em> Under).</p>
<p>Other modifiers control array traversal and iteration. In three cases a simpler 1-modifier is paired with a generalized 2-modifier: in each case the 1-modifier happens to be the same as the 2-modifier with a right operand of <code><span class='Number'>¯1</span></code>.</p>
<table>
<thead>
<tr>
<th>1-Modifier</th>
<th>Name</th>
<th>2-Modifier</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><code><span class='Modifier'>˘</span></code></td>
<td>Cells</td>
<td><code><span class='Modifier2'>⎉</span></code></td>
<td>Rank</td>
</tr>
<tr>
<td><code><span class='Modifier'>¨</span></code></td>
<td>Each</td>
<td><code><span class='Modifier2'>⚇</span></code></td>
<td>Depth</td>
</tr>
<tr>
<td><code><span class='Modifier'>⌜</span></code></td>
<td>Table</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code><span class='Modifier'>⁼</span></code></td>
<td>Undo</td>
<td><code><span class='Modifier2'>⍟</span></code></td>
<td>Repeat</td>
</tr>
<tr>
<td><code><span class='Modifier'>´</span></code></td>
<td>Fold</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code><span class='Modifier'>˝</span></code></td>
<td>Insert</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code><span class='Modifier'>`</span></code></td>
<td>Scan</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="types">Types</h2>
<p>BQN will initially support the following fundamental types:</p>
<ul>
<li>Number (complex with 64-bit float precision)</li>
<li>Character (Unicode code point)</li>
<li>Array</li>
<li>Function</li>
<li>1-Modifier</li>
<li>2-Modifier</li>
</ul>
<p>All of these types are immutable, and immutable types should be the default for BQN. The only mutable type likely to be added is the namespace or scope.</p>

